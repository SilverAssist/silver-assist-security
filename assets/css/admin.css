/**
 * Silver Assist Security Essentials - Admin Panel Styles
 *
 * Hybrid CSS approach: CSS Layers for organization + High specificity for WordPress conflicts.
 * Uses CSS layers for custom components and scoped selectors for elements that WordPress overrides.
 *
 * @package SilverAssist\Security
 * @since 1.0.0
 * @author Silver Assist
 * @copyright Copyright (c) 2025, Silver Assist
 * @license Polyform Noncommercial License 1.0.0
 * @version 1.1.8
 */

/* =============================================================================
   HYBRID STRATEGY: CSS LAYERS + HIGH SPECIFICITY
   ============================================================================= */

@layer components, utilities;

/* =============================================================================
   COMPONENTS LAYER - FOR CUSTOM SILVER ASSIST CLASSES
   ============================================================================= */

@layer components {

    /* Dashboard Components - Safe to use in layers */
    .silver-assist-dashboard {
        background: var(--silver-bg-secondary);
        border-radius: var(--silver-radius-lg);
        margin-block-end: var(--silver-spacing-3xl);
        container-type: inline-size;
    }

    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: var(--silver-responsive-gap);
        margin-block-end: var(--silver-spacing-2xl);
        padding-block-end: var(--silver-spacing-lg);
        border-block-end: var(--silver-border-width-base) solid var(--silver-border-secondary);
    }

    .dashboard-refresh {
        display: flex;
        align-items: center;
        gap: var(--silver-spacing-lg);
    }

    .last-updated {
        font-size: var(--silver-font-size-fluid-base);
        color: var(--silver-text-muted);
    }

    #last-updated-time {
        font-weight: var(--silver-font-weight-semibold);
        color: var(--silver-text-primary);
    }

    #refresh-dashboard {
        background: var(--silver-primary-blue);
        color: var(--silver-bg-primary);
        border: none;
        padding-inline: var(--silver-spacing-lg);
        padding-block: var(--silver-spacing-sm);
        border-radius: var(--silver-radius-base);
        cursor: pointer;
        font-size: var(--silver-font-size-base);
        transition: background-color var(--silver-transition-fast);

        &:hover {
            background: var(--silver-primary-blue-hover);
        }

        &:disabled {
            background: var(--silver-disabled-bg);
            cursor: not-allowed;
        }
    }

    /* Dashboard Cards Grid */
    .silver-stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--silver-spacing-xl);
        margin-block-end: var(--silver-spacing-2xl);
        container-type: inline-size;
    }

    .status-card {
        background: var(--silver-bg-primary);
        border: var(--silver-border-width-thin) solid var(--silver-border-secondary);
        border-radius: var(--silver-radius-lg);
        padding: var(--silver-fluid-spacing);
        box-shadow: var(--silver-shadow-md);
        transition: transform var(--silver-transition-fast), box-shadow var(--silver-transition-fast);
        container-type: inline-size;

        &:hover {
            transform: translateY(-2px);
            box-shadow: var(--silver-shadow-lg);
        }
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: var(--silver-spacing-md);
        margin-block-end: var(--silver-spacing-lg);
        padding-block-end: var(--silver-spacing-md);
        border-block-end: var(--silver-border-width-thin) solid var(--silver-border-lighter);
    }

    .status-indicator {
        padding-inline: var(--silver-spacing-md);
        padding-block: var(--silver-spacing-xs);
        border-radius: var(--silver-radius-pill);
        font-size: var(--silver-font-size-sm);
        font-weight: var(--silver-font-weight-semibold);
        text-transform: uppercase;
        letter-spacing: var(--silver-letter-spacing-tight);

        &.active {
            background: var(--silver-success-bg-light);
            color: var(--silver-success-text);
            border: var(--silver-border-width-thin) solid var(--silver-success-border-light);
        }

        &.disabled {
            background: var(--silver-error-bg-light);
            color: var(--silver-error-text);
            border: var(--silver-border-width-thin) solid var(--silver-error-border-light);
        }

        &.warning {
            background: var(--silver-warning-bg-light);
            color: var(--silver-warning-text);
            border: var(--silver-border-width-thin) solid var(--silver-warning-border);
        }
    }

    /* Card Content */
    .card-content {
        display: flex;
        flex-direction: column;
        gap: var(--silver-spacing-md);
    }

    .stat {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--silver-spacing-sm) 0;
    }

    .stat-value {
        font-size: var(--silver-font-size-2xl);
        font-weight: var(--silver-font-weight-bold);
        color: var(--silver-primary-blue);
    }

    .stat-label {
        font-size: var(--silver-font-size-sm);
        color: var(--silver-text-muted);
        text-transform: uppercase;
        letter-spacing: var(--silver-letter-spacing-normal);
    }

    .feature-status {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-block-end: var(--silver-spacing-md);
        border-block-end: var(--silver-border-width-thin) solid var(--silver-border-lightest);

        &:last-child {
            border-block-end: none;
        }
    }

    .feature-name {
        font-size: var(--silver-font-size-sm);
        color: var(--silver-text-primary);
    }

    .feature-value {
        font-size: var(--silver-font-size-sm);
        font-weight: var(--silver-font-weight-semibold);
        padding-inline: var(--silver-spacing-sm);
        padding-block: var(--silver-spacing-xs);
        border-radius: var(--silver-radius-base);
        text-transform: uppercase;
        letter-spacing: var(--silver-letter-spacing-tight);

        &.enabled {
            background: var(--silver-success-bg-light);
            color: var(--silver-success-text);
        }

        &.disabled {
            background: var(--silver-error-bg-light);
            color: var(--silver-error-text);
        }
    }

    /* Form Table Base Styles */
    .form-table {
        th {
            inline-size: var(--silver-input-width-lg);
            font-weight: var(--silver-font-weight-semibold);
            color: var(--silver-text-primary);
            padding: var(--silver-spacing-lg) var(--silver-spacing-md) var(--silver-spacing-lg) 0;
        }

        td {
            padding: var(--silver-spacing-lg) var(--silver-spacing-md);
        }
    }

    .description {
        font-style: italic;
        color: var(--silver-text-muted);
        font-size: var(--silver-font-size-base);
        margin-top: var(--silver-spacing-xs);
    }

    /* Toggle Switches */
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: var(--silver-toggle-width);
        height: var(--silver-toggle-height);
        margin-right: var(--silver-spacing-md);

        input[type="checkbox"] {
            opacity: 0;
            width: 0;
            height: 0;
            margin: 0;
        }

        &.checked .slider {
            background-color: var(--silver-primary-blue);

            &:before {
                transform: translateX(var(--silver-toggle-thumb-translate));
            }
        }
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: var(--silver-disabled-bg);
        transition: var(--silver-transition-base);
        border-radius: var(--silver-toggle-height);

        &:before {
            position: absolute;
            content: "";
            height: var(--silver-toggle-thumb-size);
            width: var(--silver-toggle-thumb-size);
            left: var(--silver-toggle-thumb-offset);
            bottom: var(--silver-toggle-thumb-offset);
            background-color: var(--silver-bg-primary);
            transition: var(--silver-transition-base);
            border-radius: var(--silver-radius-circle);
            box-shadow: var(--silver-shadow-sm);
        }
    }

    /* Threats Section */
    .dashboard-threats {
        background: var(--silver-bg-primary);
        border: var(--silver-border-width-thin) solid var(--silver-border-secondary);
        border-radius: var(--silver-radius-lg);
        overflow: hidden;
        margin-block-end: var(--silver-spacing-2xl);
    }

    .threats-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--silver-spacing-xl);
        background: var(--silver-bg-tertiary);
        border-bottom: var(--silver-border-width-thin) solid var(--silver-border-secondary);
    }

    .threats-header h3 {
        margin: 0;
        color: var(--silver-text-primary);
        font-size: var(--silver-font-size-xl);
        font-weight: var(--silver-font-weight-semibold);
    }

    .threat-count {
        background: var(--silver-error-secondary);
        color: var(--silver-bg-primary);
        padding: var(--silver-spacing-xs) var(--silver-spacing-md);
        border-radius: var(--silver-radius-pill);
        font-size: var(--silver-font-size-md);
        font-weight: var(--silver-font-weight-semibold);
    }

    .threats-content {
        padding: var(--silver-spacing-xl);
    }

    /* Path Validation Styles */
    .validation-indicator {
        margin-top: var(--silver-spacing-sm);
        padding: var(--silver-spacing-sm) var(--silver-spacing-md);
        border-radius: var(--silver-radius-base);
        font-size: var(--silver-font-size-sm);
        font-weight: var(--silver-font-weight-medium);
        display: inline-block;
        transition: all var(--silver-transition-base) ease;

        &.valid {
            background: var(--silver-success-bg);
            color: var(--silver-success-text);
            border: var(--silver-border-width-thin) solid var(--silver-success-border);
        }

        &.invalid {
            background: var(--silver-error-bg);
            color: var(--silver-error-text);
            border: var(--silver-border-width-thin) solid var(--silver-error-border);
        }

        &.validating {
            background: var(--silver-primary-blue-light);
            color: var(--silver-primary-blue);
            border: var(--silver-border-width-thin) solid var(--silver-border-primary);
            animation: validationPulse 1.5s ease-in-out infinite;
        }
    }

}

/* =============================================================================
   UTILITIES LAYER - HELPER CLASSES
   ============================================================================= */

@layer utilities {

    /* Loading & Error States */
    .loading {
        text-align: center;
        color: var(--silver-text-muted);
        font-style: italic;
        padding: var(--silver-spacing-xl) 0;
        margin: 0;

        &:after {
            content: '';
            display: inline-block;
            width: var(--silver-spacing-lg);
            height: var(--silver-spacing-lg);
            margin-left: var(--silver-spacing-sm);
            border: var(--silver-border-width-base) solid var(--silver-border-light);
            border-radius: 50%;
            border-top-color: var(--silver-info-primary);
            animation: spin 1s var(--silver-transition-ease-in-out) infinite;
        }
    }

    .error {
        text-align: center;
        color: var(--silver-error-secondary);
        font-weight: var(--silver-font-weight-semibold);
        padding: var(--silver-spacing-xl) 0;
        margin: 0;
    }

    .no-threats {
        text-align: center;
        color: var(--silver-success-secondary);
        font-weight: var(--silver-font-weight-semibold);
        padding: var(--silver-spacing-xl) 0;
        margin: 0 !important;
    }

    /* Utility classes */
    .sr-only {
        position: absolute;
        inline-size: 1px;
        block-size: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

}

/* =============================================================================
   RESPONSIVE DESIGN - OUTSIDE LAYERS FOR PROPER CASCADE
   ============================================================================= */

/* Container queries for responsive components */
@container (max-width: 768px) {
    .dashboard-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .dashboard-refresh {
        inline-size: 100%;
        justify-content: space-between;
    }

    .card-header {
        align-items: flex-start;
        gap: var(--silver-spacing-sm);
    }
}

@container (max-width: 480px) {
    .silver-assist-security-admin .dashboard-header h2 {
        font-size: var(--silver-font-size-fluid-lg);
    }

    .silver-assist-security-admin .card-header h3 {
        font-size: var(--silver-font-size-md);
    }

    .status-card {
        padding: var(--silver-spacing-lg);
    }
}

@container (max-width: 300px) {
    .status-card {
        padding: var(--silver-spacing-lg);
    }
}

/* Traditional media queries for layout */
@media (max-width: 1200px) {
    .silver-stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--silver-spacing-lg);
    }
}

@media (max-width: 768px) {
    .silver-assist-dashboard {
        padding: var(--silver-spacing-lg);
        margin-block-end: var(--silver-spacing-xl);
    }

    .silver-stats-grid {
        grid-template-columns: 1fr;
        gap: var(--silver-spacing-lg);
    }

    .silver-assist-security-admin .form-table th {
        inline-size: var(--silver-input-width-md);
    }
}

@media (max-width: 480px) {
    .silver-assist-security-admin .form-table th {
        display: block;
        inline-size: 100%;
        padding: var(--silver-spacing-sm) 0;
        font-weight: var(--silver-font-weight-semibold);
        margin-block-end: var(--silver-spacing-xs);
    }

    .silver-assist-security-admin .form-table td {
        display: block;
        inline-size: 100%;
        padding: var(--silver-spacing-sm) 0;
    }

    .silver-assist-security-admin .card {
        padding: var(--silver-spacing-lg);
    }
}

/* =============================================================================
   ACCESSIBILITY & FOCUS STATES - OUTSIDE LAYERS FOR PRIORITY
   ============================================================================= */

/* Focus states with high specificity */
.silver-assist-security-admin {

    .status-indicator:focus,
    .toggle-switch input[type="checkbox"]:focus+.slider {
        outline: var(--silver-border-width-base) solid var(--silver-primary-blue);
        outline-offset: 2px;
    }

    input:focus,
    button:focus {
        outline: var(--silver-border-width-base) solid var(--silver-primary-blue);
        outline-offset: 1px;
    }
}

/* =============================================================================
   WORDPRESS OVERRIDES - HIGH SPECIFICITY FOR CONFLICTING ELEMENTS
   ============================================================================= */

/* WordPress often overrides these elements, so we use high specificity */
.silver-assist-security-admin {
    .dashboard-header h2 {
        margin: 0;
        color: var(--silver-text-primary);
        font-size: var(--silver-font-size-fluid-lg);
        font-weight: var(--silver-font-weight-semibold);
    }

    .card-header h3 {
        margin: 0;
        font-size: var(--silver-font-size-fluid-base);
        font-weight: var(--silver-font-weight-semibold);
        color: var(--silver-text-primary);
    }

    /* WordPress .card class conflicts */
    .card {
        background: var(--silver-bg-primary);
        border: var(--silver-border-width-thin) solid var(--silver-border-primary);
        border-radius: var(--silver-radius-lg);
        padding: var(--silver-fluid-spacing-lg);
        margin-block-end: var(--silver-spacing-2xl);
        box-shadow: var(--silver-shadow-md);
        transition: box-shadow var(--silver-transition-fast);
        max-width: var(--silver-card-max-width);
        max-inline-size: var(--silver-card-max-width);
        container-type: inline-size;

        &:hover {
            box-shadow: var(--silver-shadow-lg);
        }

        h2 {
            margin-block: 0 var(--silver-spacing-xl);
            font-size: var(--silver-font-size-fluid-lg);
            font-weight: var(--silver-font-weight-semibold);
            color: var(--silver-text-primary);
            border-block-end: var(--silver-border-width-thin) solid var(--silver-border-light);
            padding-block-end: var(--silver-spacing-md);
        }
    }

    /* Form inputs that WordPress styles heavily */
    .form-table {
        input[type="number"] {
            inline-size: var(--silver-input-width-sm);
            border: var(--silver-border-width-thin) solid var(--silver-border-secondary);
            border-radius: var(--silver-radius-base);

            &:focus {
                border-color: var(--silver-primary-blue);
                box-shadow: 0 0 0 var(--silver-border-width-thin) var(--silver-primary-blue);
                outline: none;
            }
        }

        input[type="checkbox"] {
            margin-inline-end: var(--silver-spacing-md);
            transform: scale(1.1);
        }

        input[type="text"] {
            inline-size: var(--silver-input-width-md);
            border: var(--silver-border-width-thin) solid var(--silver-border-secondary);
            border-radius: var(--silver-radius-base);

            &:focus {
                border-color: var(--silver-primary-blue);
                box-shadow: 0 0 0 var(--silver-border-width-thin) var(--silver-primary-blue);
                outline: none;
            }

            /* Input validation states */
            &.validation-validating {
                border-color: var(--silver-primary-blue);
                box-shadow: 0 0 0 var(--silver-border-width-thin) var(--silver-primary-blue-light);
            }

            &.validation-valid {
                border-color: var(--silver-success-primary);
                box-shadow: 0 0 0 var(--silver-border-width-thin) var(--silver-success-bg);
            }

            &.validation-invalid {
                border-color: var(--silver-error-primary);
                box-shadow: 0 0 0 var(--silver-border-width-thin) var(--silver-error-bg);
            }
        }
    }

    /* Buttons that WordPress styles */
    button,
    input[type="submit"],
    #refresh-dashboard {
        background: var(--silver-primary-blue);
        color: var(--silver-bg-primary);
        border: none;
        border-radius: var(--silver-radius-base);
        cursor: pointer;
        transition: background-color var(--silver-transition-fast);

        &:hover {
            background: var(--silver-primary-blue-hover);
        }

        &:disabled {
            background: var(--silver-disabled-bg);
            cursor: not-allowed;
        }
    }

    /* Table elements WordPress commonly overrides */
    table {
        width: 100%;
        background: var(--silver-bg-primary);
        border-radius: var(--silver-radius-md);
        overflow: hidden;
        box-shadow: var(--silver-shadow-sm);

        th {
            background: var(--silver-bg-tertiary);
            color: var(--silver-text-secondary);
            font-weight: var(--silver-font-weight-semibold);
            text-align: left;
            padding: var(--silver-spacing-md) var(--silver-spacing-lg);
            border-bottom: var(--silver-border-width-thin) solid var(--silver-border-light);
        }

        td {
            padding: var(--silver-spacing-md) var(--silver-spacing-lg);
            border-bottom: var(--silver-border-width-thin) solid var(--silver-border-lighter);
        }
    }
}

/* =============================================================================
   GRAPHQL SECURITY CARD SPECIFIC STYLES
   ============================================================================= */

/* GraphQL headless mode indicator component */
.headless-mode-indicator {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-block-end: var(--silver-spacing-md);
    margin-block-end: var(--silver-spacing-lg);
    border-block-end: var(--silver-border-width-thin) solid var(--silver-border-lightest);
}

.mode-label {
    font-size: var(--silver-font-size-sm);
    color: var(--silver-text-primary);
    font-weight: var(--silver-font-weight-medium);
}

.mode-value {
    font-size: var(--silver-font-size-xs);
    font-weight: var(--silver-font-weight-semibold);
    padding: var(--silver-spacing-sm) var(--silver-spacing-lg);
    border-radius: var(--silver-radius-base);
    text-transform: uppercase;
    letter-spacing: var(--silver-letter-spacing-tight);
    transition: all var(--silver-transition-base) var(--silver-transition-ease);
}

.mode-value.headless {
    background: var(--silver-headless-bg);
    color: var(--silver-headless-text);
}

.mode-value.standard {
    background: var(--silver-standard-bg);
    color: var(--silver-standard-text);
}

/* Hover effects for mode values */
.mode-value:hover {
    transform: scale(1.02);
    box-shadow: var(--silver-shadow-sm);
}

/* Responsive adjustments for mode indicator */
@container (max-width: 400px) {
    .headless-mode-indicator {
        align-items: flex-start;
        gap: var(--silver-spacing-sm);
    }

    .mode-value {
        align-self: flex-end;
    }
}


/* High contrast mode support */
@media (prefers-contrast: high) {
    .silver-assist-security-admin {
        .status-card {
            border: var(--silver-border-width-base) solid var(--silver-border-dark);
        }

        .status-indicator {
            border: var(--silver-border-width-base) solid var(--silver-border-dark);
        }
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .silver-assist-security-admin {

        *,
        *::before,
        *::after {
            animation-duration: 0.01ms;
            transition-duration: 0.01ms;
            animation-iteration-count: 1;
        }
    }
}

/* Keyframe animations */
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes validationPulse {

    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.8;
        transform: scale(1.02);
    }
}